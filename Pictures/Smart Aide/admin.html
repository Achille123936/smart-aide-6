<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administration - EduBot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --accent-color: #7209b7;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --success-color: #4cc9f0;
            --warning-color: #f72585;
            --correct-color: #4ade80;
            --incorrect-color: #f87171;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .nav-tab {
            padding: 8px 16px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 20px;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .nav-tab:hover, .nav-tab.active {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .back-button {
            display: inline-flex;
            align-items: center;
            padding: 10px 20px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            transition: var(--transition);
        }
        
        .back-button:hover {
            background-color: rgba(255, 255, 255, 0.3);
            transform: translateX(-5px);
        }
        
        .back-button i {
            margin-right: 8px;
        }
        
        .admin-content {
            padding: 30px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .admin-title {
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark-color);
        }
        
        .admin-title h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .admin-title p {
            color: #6c757d;
            font-size: 1.1rem;
        }
        
        /* Panneau d'administration */
        .admin-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
        }
        
        .admin-actions-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .logout-btn {
            padding: 8px 16px;
            background: var(--incorrect-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .logout-btn:hover {
            opacity: 0.9;
        }
        
        .admin-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .admin-btn {
            padding: 10px 16px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .admin-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .admin-btn.delete {
            background: var(--incorrect-color);
        }
        
        .admin-btn.success {
            background: var(--correct-color);
        }
        
        .admin-btn.warning {
            background: var(--warning-color);
        }
        
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .admin-tab {
            padding: 10px 20px;
            background: #f8f9fa;
            color: var(--dark-color);
            text-decoration: none;
            border-radius: 8px;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .admin-tab:hover, .admin-tab.active {
            background: var(--primary-color);
            color: white;
        }
        
        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .admin-table th, .admin-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .admin-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .admin-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 6px 10px;
            background: none;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
        }
        
        .edit-btn {
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }
        
        .delete-btn {
            color: var(--incorrect-color);
            border: 1px solid var(--incorrect-color);
        }
        
        .view-btn {
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }
        
        .action-btn:hover {
            background-color: #f0f0f0;
        }
        
        /* Formulaire d'administration */
        .admin-form {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-top: 20px;
            display: none;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-color);
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            transition: var(--transition);
            font-size: 1rem;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        /* Connexion administrateur */
        .login-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 400px;
            margin: 0 auto;
        }
        
        .login-title {
            text-align: center;
            margin-bottom: 25px;
            color: var(--dark-color);
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .login-btn {
            padding: 12px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            opacity: 0.9;
        }
        
        /* Section des questions */
        .questions-container {
            margin-top: 20px;
        }
        
        .question-form {
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: #f8f9fa;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .question-number {
            font-weight: 500;
        }
        
        .delete-question-btn {
            background: var(--incorrect-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .option-input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .option-input {
            flex: 1;
        }
        
        .correct-option {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }
        
        /* Modal de confirmation */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 1.5rem;
            color: var(--dark-color);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6c757d;
        }
        
        .close-modal:hover {
            color: var(--dark-color);
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* Statistiques */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 1.5rem;
            color: white;
        }
        
        .stat-icon.exams {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
        }
        
        .stat-icon.questions {
            background: linear-gradient(45deg, var(--success-color), #16a34a);
        }
        
        .stat-icon.users {
            background: linear-gradient(45deg, var(--warning-color), #dc2626);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark-color);
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .admin-actions-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .admin-actions {
                flex-wrap: wrap;
            }
            
            .admin-tabs {
                flex-wrap: wrap;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .option-input-group {
                grid-template-columns: 1fr;
            }
            
            .admin-table {
                display: block;
                overflow-x: auto;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <div>
                <h1><i class="fas fa-cog"></i> Administration EduBot</h1>
                <div class="nav-tabs">
                    <a href="index.html" class="nav-tab">
                        <i class="fas fa-home"></i> Accueil
                    </a>
                    <a href="exams.html" class="nav-tab">
                        <i class="fas fa-graduation-cap"></i> Examens
                    </a>
                    <a href="#" class="nav-tab active">
                        <i class="fas fa-cog"></i> Administration
                    </a>
                </div>
            </div>
            <a href="index.html" class="back-button">
                <i class="fas fa-arrow-left"></i> Retour à l'Accueil
            </a>
        </div>

        <div class="admin-content">
            <!-- Connexion administrateur -->
            <div class="tab-content active" id="admin-login-tab">
                <div class="login-container">
                    <div class="login-title">
                        <h2>Connexion Administrateur</h2>
                        <p>Veuillez vous connecter pour accéder au panneau d'administration</p>
                    </div>
                    <div class="login-form">
                        <div class="form-group">
                            <label class="form-label" for="admin-username">Nom d'utilisateur</label>
                            <input type="text" class="form-input" id="admin-username" placeholder="Entrez votre nom d'utilisateur">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="admin-password">Mot de passe</label>
                            <input type="password" class="form-input" id="admin-password" placeholder="Entrez votre mot de passe">
                        </div>
                        <button class="login-btn" id="admin-login-btn">
                            <i class="fas fa-sign-in-alt"></i> Se connecter
                        </button>
                    </div>
                </div>
            </div>

            <!-- Panneau d'administration -->
            <div class="tab-content" id="admin-panel-tab" style="display: none;">
                <div class="admin-panel">
                    <div class="admin-actions-container">
                        <div>
                            <h2>Panneau d'Administration</h2>
                            <p>Bienvenue, <span id="admin-name">Administrateur</span></p>
                        </div>
                        <button class="logout-btn" id="admin-logout-btn">
                            <i class="fas fa-sign-out-alt"></i> Déconnexion
                        </button>
                    </div>

                    <!-- Statistiques -->
                    <div class="stats-container">
                        <div class="stat-card">
                            <div class="stat-icon exams">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <div class="stat-value" id="total-exams">0</div>
                            <div class="stat-label">Examens créés</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon questions">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <div class="stat-value" id="total-questions">0</div>
                            <div class="stat-label">Questions totales</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon users">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-value" id="total-users">0</div>
                            <div class="stat-label">Utilisateurs actifs</div>
                        </div>
                    </div>

                    <!-- Onglets d'administration -->
                    <div class="admin-tabs">
                        <a href="#" class="admin-tab active" data-tab="exams-management">Gestion des Examens</a>
                        <a href="#" class="admin-tab" data-tab="questions-management">Gestion des Questions</a>
                        <a href="#" class="admin-tab" data-tab="users-management">Gestion des Utilisateurs</a>
                        <a href="#" class="admin-tab" data-tab="settings-management">Paramètres</a>
                    </div>

                    <!-- Gestion des examens -->
                    <div class="admin-tab-content active" id="exams-management">
                        <div class="admin-actions">
                            <button class="admin-btn" id="add-exam-btn">
                                <i class="fas fa-plus"></i> Ajouter un Examen
                            </button>
                            <button class="admin-btn" id="refresh-exams-btn">
                                <i class="fas fa-sync-alt"></i> Actualiser
                            </button>
                            <button class="admin-btn warning" id="export-exams-btn">
                                <i class="fas fa-download"></i> Exporter
                            </button>
                        </div>

                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nom</th>
                                    <th>Matière</th>
                                    <th>Difficulté</th>
                                    <th>Durée</th>
                                    <th>Questions</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="exams-table-body">
                                <!-- Les examens seront chargés dynamiquement -->
                            </tbody>
                        </table>

                        <!-- Formulaire d'examen -->
                        <div class="admin-form" id="exam-form">
                            <h3 id="form-title">Ajouter un Examen</h3>
                            <div class="form-group">
                                <label class="form-label" for="exam-name">Nom de l'examen</label>
                                <input type="text" class="form-input" id="exam-name" placeholder="Entrez le nom de l'examen">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="exam-subject">Matière</label>
                                    <select class="form-select" id="exam-subject">
                                        <option value="math">Mathématiques</option>
                                        <option value="french">Français</option>
                                        <option value="science">Sciences</option>
                                        <option value="history">Histoire-Géographie</option>
                                        <option value="english">Anglais</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="exam-difficulty">Difficulté</label>
                                    <select class="form-select" id="exam-difficulty">
                                        <option value="easy">Facile</option>
                                        <option value="medium">Moyen</option>
                                        <option value="hard">Difficile</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="exam-description">Description</label>
                                <textarea class="form-textarea" id="exam-description" placeholder="Décrivez l'examen"></textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="exam-duration">Durée (en minutes)</label>
                                    <input type="number" class="form-input" id="exam-duration" min="5" max="180" value="60">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="exam-status">Statut</label>
                                    <select class="form-select" id="exam-status">
                                        <option value="active">Actif</option>
                                        <option value="inactive">Inactif</option>
                                        <option value="draft">Brouillon</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="exam-instructions">Instructions</label>
                                <textarea class="form-textarea" id="exam-instructions" placeholder="Entrez les instructions pour l'examen"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Questions</label>
                                <div id="questions-container">
                                    <!-- Les questions seront ajoutées dynamiquement -->
                                </div>
                                <button type="button" class="admin-btn" id="add-question-btn">
                                    <i class="fas fa-plus"></i> Ajouter une Question
                                </button>
                            </div>
                            <div class="form-actions">
                                <button class="admin-btn delete" id="cancel-exam-btn">Annuler</button>
                                <button class="admin-btn success" id="save-exam-btn">Enregistrer</button>
                            </div>
                        </div>
                    </div>

                    <!-- Gestion des questions -->
                    <div class="admin-tab-content" id="questions-management" style="display: none;">
                        <div class="admin-actions">
                            <button class="admin-btn" id="add-question-global-btn">
                                <i class="fas fa-plus"></i> Ajouter une Question
                            </button>
                            <button class="admin-btn" id="import-questions-btn">
                                <i class="fas fa-upload"></i> Importer
                            </button>
                            <button class="admin-btn warning" id="export-questions-btn">
                                <i class="fas fa-download"></i> Exporter
                            </button>
                        </div>

                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Question</th>
                                    <th>Matière</th>
                                    <th>Difficulté</th>
                                    <th>Type</th>
                                    <th>Examen</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="questions-table-body">
                                <!-- Les questions seront chargées dynamiquement -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Gestion des utilisateurs -->
                    <div class="admin-tab-content" id="users-management" style="display: none;">
                        <div class="admin-actions">
                            <button class="admin-btn" id="add-user-btn">
                                <i class="fas fa-plus"></i> Ajouter un Utilisateur
                            </button>
                            <button class="admin-btn" id="refresh-users-btn">
                                <i class="fas fa-sync-alt"></i> Actualiser
                            </button>
                        </div>

                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nom</th>
                                    <th>Email</th>
                                    <th>Rôle</th>
                                    <th>Date d'inscription</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="users-table-body">
                                <!-- Les utilisateurs seront chargés dynamiquement -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Paramètres -->
                    <div class="admin-tab-content" id="settings-management" style="display: none;">
                        <div class="admin-form">
                            <h3>Paramètres du Système</h3>
                            <div class="form-group">
                                <label class="form-label" for="system-name">Nom du système</label>
                                <input type="text" class="form-input" id="system-name" value="EduBot Examens">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="admin-email">Email administrateur</label>
                                <input type="email" class="form-input" id="admin-email" value="admin@edubot.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="max-exam-duration">Durée maximale d'examen (minutes)</label>
                                <input type="number" class="form-input" id="max-exam-duration" min="30" max="300" value="180">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="passing-score">Score de passage (%)</label>
                                <input type="number" class="form-input" id="passing-score" min="50" max="100" value="70">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="system-language">Langue du système</label>
                                <select class="form-select" id="system-language">
                                    <option value="fr">Français</option>
                                    <option value="en">English</option>
                                    <option value="es">Español</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button class="admin-btn delete" id="reset-settings-btn">Réinitialiser</button>
                                <button class="admin-btn success" id="save-settings-btn">Enregistrer les paramètres</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmation -->
    <div class="modal" id="confirmation-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-confirmation-title">Confirmation</h3>
                <button class="close-modal" id="close-confirmation-modal">&times;</button>
            </div>
            <div class="modal-body" id="modal-confirmation-body">
                Êtes-vous sûr de vouloir effectuer cette action ?
            </div>
            <div class="modal-footer">
                <button class="admin-btn delete" id="cancel-confirmation-btn">Annuler</button>
                <button class="admin-btn success" id="confirm-action-btn">Confirmer</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Éléments DOM
            const adminLoginTab = document.getElementById('admin-login-tab');
            const adminPanelTab = document.getElementById('admin-panel-tab');
            const adminLoginBtn = document.getElementById('admin-login-btn');
            const adminLogoutBtn = document.getElementById('admin-logout-btn');
            const adminName = document.getElementById('admin-name');
            const adminUsernameInput = document.getElementById('admin-username');
            const adminPasswordInput = document.getElementById('admin-password');
            
            // Éléments de gestion des examens
            const examsTableBody = document.getElementById('exams-table-body');
            const examForm = document.getElementById('exam-form');
            const addExamBtn = document.getElementById('add-exam-btn');
            const cancelExamBtn = document.getElementById('cancel-exam-btn');
            const saveExamBtn = document.getElementById('save-exam-btn');
            const addQuestionBtn = document.getElementById('add-question-btn');
            const questionsContainer = document.getElementById('questions-container');
            const refreshExamsBtn = document.getElementById('refresh-exams-btn');
            
            // Éléments des onglets
            const adminTabs = document.querySelectorAll('.admin-tab');
            const adminTabContents = document.querySelectorAll('.admin-tab-content');
            
            // Éléments des statistiques
            const totalExamsEl = document.getElementById('total-exams');
            const totalQuestionsEl = document.getElementById('total-questions');
            const totalUsersEl = document.getElementById('total-users');
            
            // Éléments du modal
            const confirmationModal = document.getElementById('confirmation-modal');
            const modalConfirmationTitle = document.getElementById('modal-confirmation-title');
            const modalConfirmationBody = document.getElementById('modal-confirmation-body');
            const closeConfirmationModal = document.getElementById('close-confirmation-modal');
            const cancelConfirmationBtn = document.getElementById('cancel-confirmation-btn');
            const confirmActionBtn = document.getElementById('confirm-action-btn');

            // Variables
            let isAdminLoggedIn = false;
            let isEditingExam = false;
            let editingExamId = null;
            let examsData = [];
            let questionsData = [];
            let usersData = [];
            let currentAction = null;
            let currentItemId = null;

            // Informations de connexion administrateur
            const adminCredentials = {
                username: "admin",
                password: "admin123"
            };

            // Initialisation
            initializeApp();

            function initializeApp() {
                loadData();
                setupEventListeners();
                checkAdminLoginStatus();
            }

            function setupEventListeners() {
                // Connexion administrateur
                adminLoginBtn.addEventListener('click', adminLogin);
                adminLogoutBtn.addEventListener('click', adminLogout);

                // Gestion des examens
                addExamBtn.addEventListener('click', showExamForm);
                cancelExamBtn.addEventListener('click', hideExamForm);
                saveExamBtn.addEventListener('click', saveExam);
                addQuestionBtn.addEventListener('click', addQuestionForm);
                refreshExamsBtn.addEventListener('click', refreshAdminData);

                // Navigation par onglets
                adminTabs.forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        e.preventDefault();
                        const tabId = tab.getAttribute('data-tab');
                        switchAdminTab(tabId);
                    });
                });

                // Modal de confirmation
                closeConfirmationModal.addEventListener('click', () => {
                    confirmationModal.style.display = 'none';
                });
                cancelConfirmationBtn.addEventListener('click', () => {
                    confirmationModal.style.display = 'none';
                });
                confirmActionBtn.addEventListener('click', executeConfirmedAction);
                
                // Fermer le modal en cliquant à l'extérieur
                window.addEventListener('click', (e) => {
                    if (e.target === confirmationModal) {
                        confirmationModal.style.display = 'none';
                    }
                });
            }

            function checkAdminLoginStatus() {
                const adminStatus = localStorage.getItem('adminLoggedIn');
                if (adminStatus === 'true') {
                    isAdminLoggedIn = true;
                    showAdminPanel();
                }
            }

            function adminLogin() {
                const username = adminUsernameInput.value;
                const password = adminPasswordInput.value;
                
                if (username === adminCredentials.username && password === adminCredentials.password) {
                    isAdminLoggedIn = true;
                    localStorage.setItem('adminLoggedIn', 'true');
                    showAdminPanel();
                } else {
                    alert('Nom d\'utilisateur ou mot de passe incorrect.');
                }
            }
            
            function adminLogout() {
                isAdminLoggedIn = false;
                localStorage.removeItem('adminLoggedIn');
                adminLoginTab.classList.add('active');
                adminPanelTab.style.display = 'none';
                adminUsernameInput.value = '';
                adminPasswordInput.value = '';
            }
            
            function showAdminPanel() {
                adminLoginTab.classList.remove('active');
                adminPanelTab.style.display = 'block';
                adminName.textContent = 'Administrateur';
                refreshAdminData();
                updateStats();
            }

            function switchAdminTab(tabId) {
                // Mettre à jour les onglets actifs
                adminTabs.forEach(tab => {
                    if (tab.getAttribute('data-tab') === tabId) {
                        tab.classList.add('active');
                    } else {
                        tab.classList.remove('active');
                    }
                });

                // Afficher le contenu de l'onglet sélectionné
                adminTabContents.forEach(content => {
                    if (content.id === tabId) {
                        content.classList.add('active');
                    } else {
                        content.classList.remove('active');
                    }
                });
            }

            function loadData() {
                const savedExams = localStorage.getItem('examsData');
                if (savedExams) {
                    examsData = JSON.parse(savedExams);
                } else {
                    // Données par défaut
                    examsData = [
                        {
                            id: 1,
                            name: 'Examen de Mathématiques - Niveau 1',
                            subject: 'math',
                            difficulty: 'medium',
                            description: 'Examen complet de mathématiques couvrant l\'algèbre, la géométrie et les probabilités.',
                            duration: 60,
                            status: 'active',
                            instructions: [
                                'Cet examen comporte 20 questions à choix multiples.',
                                'Vous avez 60 minutes pour compléter l\'examen.',
                                'Chaque question a une seule réponse correcte.',
                                'Votre score sera calculé sur la base des réponses correctes.',
                                'Vous ne pouvez pas revenir en arrière après avoir soumis l\'examen.'
                            ],
                            questions: [
                                {
                                    id: 1,
                                    question: 'Quelle est la valeur de π arrondie à deux décimales ?',
                                    options: ['3.14', '3.16', '3.12', '3.18'],
                                    correctAnswer: 1
                                },
                                {
                                    id: 2,
                                    question: 'Si x + 5 = 12, quelle est la valeur de x ?',
                                    options: ['5', '6', '7', '8'],
                                    correctAnswer: 3
                                }
                            ]
                        },
                        {
                            id: 2,
                            name: 'Examen de Français - Grammaire',
                            subject: 'french',
                            difficulty: 'easy',
                            description: 'Testez vos connaissances en grammaire française avec cet examen.',
                            duration: 45,
                            status: 'active',
                            instructions: [
                                'Cet examen comporte 15 questions à choix multiples.',
                                'Vous avez 45 minutes pour compléter l\'examen.',
                                'Chaque question a une seule réponse correcte.',
                                'Votre score sera calculé sur la base des réponses correctes.'
                            ],
                            questions: [
                                {
                                    id: 3,
                                    question: 'Quel est le participe passé du verbe "avoir" ?',
                                    options: ['avé', 'avu', 'eu', 'avue'],
                                    correctAnswer: 3
                                }
                            ]
                        }
                    ];
                    saveExamsData();
                }

                // Données utilisateurs par défaut
                usersData = [
                    { id: 1, name: 'Jean Dupont', email: 'jean.dupont@email.com', role: 'Étudiant', registrationDate: '2023-01-15', status: 'active' },
                    { id: 2, name: 'Marie Martin', email: 'marie.martin@email.com', role: 'Étudiant', registrationDate: '2023-02-20', status: 'active' },
                    { id: 3, name: 'Admin System', email: 'admin@edubot.com', role: 'Administrateur', registrationDate: '2023-01-01', status: 'active' }
                ];
            }

            function saveExamsData() {
                localStorage.setItem('examsData', JSON.stringify(examsData));
            }

            function refreshAdminData() {
                loadExamsTable();
                loadQuestionsTable();
                loadUsersTable();
                updateStats();
            }

            function updateStats() {
                // Calculer les statistiques
                let totalQuestions = 0;
                examsData.forEach(exam => {
                    totalQuestions += exam.questions.length;
                });

                totalExamsEl.textContent = examsData.length;
                totalQuestionsEl.textContent = totalQuestions;
                totalUsersEl.textContent = usersData.length;
            }

            function loadExamsTable() {
                examsTableBody.innerHTML = '';
                
                examsData.forEach(exam => {
                    const row = document.createElement('tr');
                    const statusClass = exam.status === 'active' ? 'success' : (exam.status === 'inactive' ? 'delete' : 'warning');
                    const statusText = exam.status === 'active' ? 'Actif' : (exam.status === 'inactive' ? 'Inactif' : 'Brouillon');
                    
                    row.innerHTML = `
                        <td>${exam.id}</td>
                        <td>${exam.name}</td>
                        <td>${getSubjectName(exam.subject)}</td>
                        <td>${getDifficultyText(exam.difficulty)}</td>
                        <td>${exam.duration} min</td>
                        <td>${exam.questions.length}</td>
                        <td><span class="admin-btn ${statusClass}" style="padding: 4px 8px; font-size: 0.8rem;">${statusText}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn view-btn" data-id="${exam.id}">
                                    <i class="fas fa-eye"></i> Voir
                                </button>
                                <button class="action-btn edit-btn" data-id="${exam.id}">
                                    <i class="fas fa-edit"></i> Modifier
                                </button>
                                <button class="action-btn delete-btn" data-id="${exam.id}">
                                    <i class="fas fa-trash"></i> Supprimer
                                </button>
                            </div>
                        </td>
                    `;
                    examsTableBody.appendChild(row);
                });
                
                // Ajouter les écouteurs d'événements pour les boutons d'action
                document.querySelectorAll('.view-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        viewExam(id);
                    });
                });
                
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        editExam(id);
                    });
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        showConfirmationModal('Supprimer l\'examen', 'Êtes-vous sûr de vouloir supprimer cet examen ? Cette action est irréversible.', 'deleteExam', id);
                    });
                });
            }

            function loadQuestionsTable() {
                const questionsTableBody = document.getElementById('questions-table-body');
                if (!questionsTableBody) return;
                
                questionsTableBody.innerHTML = '';
                
                // Collecter toutes les questions de tous les examens
                let allQuestions = [];
                examsData.forEach(exam => {
                    exam.questions.forEach(question => {
                        allQuestions.push({
                            ...question,
                            examName: exam.name,
                            subject: exam.subject,
                            difficulty: exam.difficulty
                        });
                    });
                });
                
                allQuestions.forEach(question => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${question.id}</td>
                        <td>${question.question.length > 50 ? question.question.substring(0, 50) + '...' : question.question}</td>
                        <td>${getSubjectName(question.subject)}</td>
                        <td>${getDifficultyText(question.difficulty)}</td>
                        <td>Choix multiple</td>
                        <td>${question.examName}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit-btn" data-id="${question.id}">
                                    <i class="fas fa-edit"></i> Modifier
                                </button>
                                <button class="action-btn delete-btn" data-id="${question.id}">
                                    <i class="fas fa-trash"></i> Supprimer
                                </button>
                            </div>
                        </td>
                    `;
                    questionsTableBody.appendChild(row);
                });
            }

            function loadUsersTable() {
                const usersTableBody = document.getElementById('users-table-body');
                if (!usersTableBody) return;
                
                usersTableBody.innerHTML = '';
                
                usersData.forEach(user => {
                    const row = document.createElement('tr');
                    const statusClass = user.status === 'active' ? 'success' : 'delete';
                    const statusText = user.status === 'active' ? 'Actif' : 'Inactif';
                    
                    row.innerHTML = `
                        <td>${user.id}</td>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>${user.role}</td>
                        <td>${user.registrationDate}</td>
                        <td><span class="admin-btn ${statusClass}" style="padding: 4px 8px; font-size: 0.8rem;">${statusText}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit-btn" data-id="${user.id}">
                                    <i class="fas fa-edit"></i> Modifier
                                </button>
                                <button class="action-btn delete-btn" data-id="${user.id}">
                                    <i class="fas fa-trash"></i> Supprimer
                                </button>
                            </div>
                        </td>
                    `;
                    usersTableBody.appendChild(row);
                });
            }

            function viewExam(id) {
                const exam = examsData.find(e => e.id === id);
                if (exam) {
                    alert(`Détails de l'examen: ${exam.name}\n\nMatière: ${getSubjectName(exam.subject)}\nDifficulté: ${getDifficultyText(exam.difficulty)}\nDurée: ${exam.duration} minutes\nNombre de questions: ${exam.questions.length}\n\nDescription: ${exam.description}`);
                }
            }

            function showExamForm() {
                isEditingExam = false;
                editingExamId = null;
                document.getElementById('form-title').textContent = 'Ajouter un Examen';
                examForm.style.display = 'block';
                resetExamForm();
            }
            
            function hideExamForm() {
                examForm.style.display = 'none';
            }
            
            function resetExamForm() {
                document.getElementById('exam-name').value = '';
                document.getElementById('exam-subject').value = 'math';
                document.getElementById('exam-description').value = '';
                document.getElementById('exam-difficulty').value = 'medium';
                document.getElementById('exam-duration').value = '60';
                document.getElementById('exam-status').value = 'active';
                document.getElementById('exam-instructions').value = '';
                questionsContainer.innerHTML = '';
                // Ajouter une question par défaut
                addQuestionForm();
            }
            
            function addQuestionForm() {
                const questionIndex = questionsContainer.children.length;
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-form';
                
                questionDiv.innerHTML = `
                    <div class="question-header">
                        <span class="question-number">Question ${questionIndex + 1}</span>
                        <button type="button" class="delete-question-btn">
                            <i class="fas fa-trash"></i> Supprimer
                        </button>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Question</label>
                        <textarea class="form-textarea question-text-input" placeholder="Entrez la question"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Options</label>
                        <div class="option-input-group">
                            <input type="text" class="form-input option-input" placeholder="Option A">
                            <input type="text" class="form-input option-input" placeholder="Option B">
                        </div>
                        <div class="option-input-group">
                            <input type="text" class="form-input option-input" placeholder="Option C">
                            <input type="text" class="form-input option-input" placeholder="Option D">
                        </div>
                        <div class="correct-option">
                            <label class="form-label">Réponse correcte:</label>
                            <select class="form-select correct-answer-select">
                                <option value="1">A</option>
                                <option value="2">B</option>
                                <option value="3">C</option>
                                <option value="4">D</option>
                            </select>
                        </div>
                    </div>
                `;
                
                questionsContainer.appendChild(questionDiv);
                
                // Ajouter l'écouteur d'événement pour le bouton de suppression
                const deleteBtn = questionDiv.querySelector('.delete-question-btn');
                deleteBtn.addEventListener('click', function() {
                    questionsContainer.removeChild(questionDiv);
                    // Renumérotez les questions
                    const questions = questionsContainer.querySelectorAll('.question-form');
                    questions.forEach((q, index) => {
                        q.querySelector('.question-number').textContent = `Question ${index + 1}`;
                    });
                });
            }
            
            function editExam(id) {
                isEditingExam = true;
                editingExamId = id;
                document.getElementById('form-title').textContent = 'Modifier l\'Examen';
                examForm.style.display = 'block';
                
                const exam = examsData.find(e => e.id === id);
                if (exam) {
                    document.getElementById('exam-name').value = exam.name;
                    document.getElementById('exam-subject').value = exam.subject;
                    document.getElementById('exam-description').value = exam.description;
                    document.getElementById('exam-difficulty').value = exam.difficulty;
                    document.getElementById('exam-duration').value = exam.duration;
                    document.getElementById('exam-status').value = exam.status;
                    document.getElementById('exam-instructions').value = exam.instructions.join('\n');
                    
                    // Charger les questions
                    questionsContainer.innerHTML = '';
                    exam.questions.forEach((question, index) => {
                        const questionDiv = document.createElement('div');
                        questionDiv.className = 'question-form';
                        
                        questionDiv.innerHTML = `
                            <div class="question-header">
                                <span class="question-number">Question ${index + 1}</span>
                                <button type="button" class="delete-question-btn">
                                    <i class="fas fa-trash"></i> Supprimer
                                </button>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Question</label>
                                <textarea class="form-textarea question-text-input" placeholder="Entrez la question">${question.question}</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Options</label>
                                <div class="option-input-group">
                                    <input type="text" class="form-input option-input" placeholder="Option A" value="${question.options[0]}">
                                    <input type="text" class="form-input option-input" placeholder="Option B" value="${question.options[1]}">
                                </div>
                                <div class="option-input-group">
                                    <input type="text" class="form-input option-input" placeholder="Option C" value="${question.options[2]}">
                                    <input type="text" class="form-input option-input" placeholder="Option D" value="${question.options[3]}">
                                </div>
                                <div class="correct-option">
                                    <label class="form-label">Réponse correcte:</label>
                                    <select class="form-select correct-answer-select">
                                        <option value="1" ${question.correctAnswer === 1 ? 'selected' : ''}>A</option>
                                        <option value="2" ${question.correctAnswer === 2 ? 'selected' : ''}>B</option>
                                        <option value="3" ${question.correctAnswer === 3 ? 'selected' : ''}>C</option>
                                        <option value="4" ${question.correctAnswer === 4 ? 'selected' : ''}>D</option>
                                    </select>
                                </div>
                            </div>
                        `;
                        
                        questionsContainer.appendChild(questionDiv);
                        
                        // Ajouter l'écouteur d'événement pour le bouton de suppression
                        const deleteBtn = questionDiv.querySelector('.delete-question-btn');
                        deleteBtn.addEventListener('click', function() {
                            questionsContainer.removeChild(questionDiv);
                            // Renumérotez les questions
                            const questions = questionsContainer.querySelectorAll('.question-form');
                            questions.forEach((q, idx) => {
                                q.querySelector('.question-number').textContent = `Question ${idx + 1}`;
                            });
                        });
                    });
                }
            }
            
            function deleteExam(id) {
                examsData = examsData.filter(e => e.id !== id);
                saveExamsData();
                refreshAdminData();
                confirmationModal.style.display = 'none';
            }
            
            function saveExam() {
                const name = document.getElementById('exam-name').value;
                const subject = document.getElementById('exam-subject').value;
                const description = document.getElementById('exam-description').value;
                const difficulty = document.getElementById('exam-difficulty').value;
                const duration = parseInt(document.getElementById('exam-duration').value);
                const status = document.getElementById('exam-status').value;
                const instructionsText = document.getElementById('exam-instructions').value;
                
                if (!name || !description || !instructionsText) {
                    alert('Veuillez remplir tous les champs obligatoires.');
                    return;
                }
                
                // Récupérer les instructions (une par ligne)
                const instructions = instructionsText.split('\n').filter(line => line.trim() !== '');
                
                // Récupérer les questions
                const questionForms = questionsContainer.querySelectorAll('.question-form');
                if (questionForms.length === 0) {
                    alert('Veuillez ajouter au moins une question.');
                    return;
                }
                
                const questions = [];
                questionForms.forEach(form => {
                    const questionText = form.querySelector('.question-text-input').value;
                    const optionInputs = form.querySelectorAll('.option-input');
                    const correctAnswer = parseInt(form.querySelector('.correct-answer-select').value);
                    
                    if (!questionText) {
                        alert('Veuillez remplir toutes les questions.');
                        return;
                    }
                    
                    const options = Array.from(optionInputs).map(input => input.value);
                    if (options.some(opt => !opt)) {
                        alert('Veuillez remplir toutes les options pour chaque question.');
                        return;
                    }
                    
                    questions.push({
                        id: questions.length + 1,
                        question: questionText,
                        options: options,
                        correctAnswer: correctAnswer
                    });
                });
                
                if (isEditingExam) {
                    // Mettre à jour l'examen existant
                    const examIndex = examsData.findIndex(e => e.id === editingExamId);
                    if (examIndex !== -1) {
                        examsData[examIndex].name = name;
                        examsData[examIndex].subject = subject;
                        examsData[examIndex].description = description;
                        examsData[examIndex].difficulty = difficulty;
                        examsData[examIndex].duration = duration;
                        examsData[examIndex].status = status;
                        examsData[examIndex].instructions = instructions;
                        examsData[examIndex].questions = questions;
                    }
                } else {
                    // Ajouter un nouvel examen
                    const newId = getNextExamId();
                    examsData.push({
                        id: newId,
                        name: name,
                        subject: subject,
                        difficulty: difficulty,
                        description: description,
                        duration: duration,
                        status: status,
                        instructions: instructions,
                        questions: questions
                    });
                }
                
                saveExamsData();
                hideExamForm();
                refreshAdminData();
            }
            
            function getNextExamId() {
                let maxId = 0;
                examsData.forEach(exam => {
                    if (exam.id > maxId) {
                        maxId = exam.id;
                    }
                });
                return maxId + 1;
            }

            function showConfirmationModal(title, message, action, itemId) {
                modalConfirmationTitle.textContent = title;
                modalConfirmationBody.textContent = message;
                currentAction = action;
                currentItemId = itemId;
                confirmationModal.style.display = 'flex';
            }

            function executeConfirmedAction() {
                switch(currentAction) {
                    case 'deleteExam':
                        deleteExam(currentItemId);
                        break;
                    // Ajouter d'autres actions ici
                }
            }

            function getDifficultyText(difficulty) {
                switch(difficulty) {
                    case 'easy': return 'Facile';
                    case 'medium': return 'Moyen';
                    case 'hard': return 'Difficile';
                    default: return 'Inconnu';
                }
            }

            function getSubjectName(subject) {
                switch(subject) {
                    case 'math': return 'Mathématiques';
                    case 'french': return 'Français';
                    case 'science': return 'Sciences';
                    case 'history': return 'Histoire-Géographie';
                    case 'english': return 'Anglais';
                    default: return 'Autre';
                }
            }
        });
    </script>
</body>
</html>